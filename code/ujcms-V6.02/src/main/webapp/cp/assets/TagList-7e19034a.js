import{d as h,r,a as c,c as y,e as k,w as t,i as o,h as e,W as M,g as T,u as O,X as J,o as W,b as X,I as G,j as Y,f as K,aD as Z,aJ as x,E as ee,k as $,t as V,as as z,a5 as ae,a2 as le,aH as te,aI as oe}from"./index-285670b0.js";import{O as se,P as ne,Q as ue,R as H,S as re}from"./content-214478a8.js";import{a as de,_ as ie,b as me,c as pe}from"./QueryItem.vue_vue_type_script_setup_true_lang-c40055fe.js";import{_ as fe}from"./DialogForm.vue_vue_type_script_setup_true_lang-2cec4ef8.js";import{_ as w}from"./LabelTip.vue_vue_type_script_setup_true_lang-3e1cb478.js";const be={name:"TagForm"},ve=h({...be,props:{modelValue:{type:Boolean,required:!0},beanId:{type:Number,default:null},beanIds:{type:Array,required:!0}},emits:{"update:modelValue":null,finished:null},setup(C){const S=r(),u=r({});return(m,n)=>{const p=c("el-input"),f=c("el-form-item");return y(),k(fe,{values:u.value,"onUpdate:values":n[2]||(n[2]=d=>u.value=d),name:m.$t("menu.content.tag"),"query-bean":o(se),"create-bean":o(ne),"update-bean":o(ue),"delete-bean":o(H),"bean-id":C.beanId,"bean-ids":C.beanIds,focus:S.value,"init-values":()=>({}),"to-values":d=>({...d}),perms:"tag","model-value":C.modelValue,"onUpdate:modelValue":n[3]||(n[3]=d=>m.$emit("update:modelValue",d)),onFinished:n[4]||(n[4]=()=>m.$emit("finished"))},{default:t(({isEdit:d})=>[e(f,{prop:"name",rules:{required:!0,message:()=>m.$t("v.required")}},{label:t(()=>[e(w,{message:"tag.name"})]),default:t(()=>[e(p,{ref_key:"focus",ref:S,modelValue:u.value.name,"onUpdate:modelValue":n[0]||(n[0]=i=>u.value.name=i),maxlength:"50"},null,8,["modelValue"])]),_:1},8,["rules"]),e(f,{prop:"description"},{label:t(()=>[e(w,{message:"tag.description"})]),default:t(()=>[e(p,{modelValue:u.value.description,"onUpdate:modelValue":n[1]||(n[1]=i=>u.value.description=i),maxlength:"1000",type:"textarea",rows:5},null,8,["modelValue"])]),_:1}),d?(y(),k(f,{key:0,prop:"created"},{label:t(()=>[e(w,{message:"tag.created"})]),default:t(()=>[e(p,{"model-value":o(M)(u.value.created).format("YYYY-MM-DD HH:mm:ss"),disabled:""},null,8,["model-value"])]),_:1})):T("",!0),d?(y(),k(f,{key:1,prop:"userId"},{label:t(()=>[e(w,{message:"tag.user"})]),default:t(()=>{var i;return[e(p,{"model-value":(i=u.value.user)==null?void 0:i.username,disabled:""},null,8,["model-value"])]}),_:1})):T("",!0),d?(y(),k(f,{key:2,prop:"refers"},{label:t(()=>[e(w,{message:"tag.refers"})]),default:t(()=>[e(p,{"model-value":u.value.refers,disabled:""},null,8,["model-value"])]),_:1})):T("",!0)]),_:1},8,["values","name","query-bean","create-bean","update-bean","delete-bean","bean-id","bean-ids","focus","init-values","to-values","model-value"])}}}),ce={class:"mb-3"},ge={class:"app-block mt-3"},ye={name:"TagList"},Ce=h({...ye,setup(C){const{t:S}=O(),u=r({}),m=r(),n=r(1),p=r(10),f=r(0),d=r(),i=r([]),I=r([]),q=r(!1),D=r(!1),P=r(),N=J(()=>i.value.map(a=>a.id)),b=async()=>{q.value=!0;try{const{content:a,totalElements:l}=await re({...Z(u.value),Q_OrderBy:m.value,page:n.value,pageSize:p.value});i.value=a,f.value=l}finally{q.value=!1}};W(b);const R=({column:a,prop:l,order:g})=>{var _;l?m.value=((_=a.sortBy)!=null?_:l)+(g==="descending"?"_desc":""):m.value=void 0,b()},j=()=>b(),E=()=>{d.value.clearSort(),x(u.value),m.value=void 0,b()},F=()=>{P.value=void 0,D.value=!0},B=a=>{P.value=a,D.value=!0},U=async a=>{await H(a),b(),ee.success(S("success"))};return(a,l)=>{const g=c("el-button"),_=c("el-popconfirm"),v=c("el-table-column"),Q=c("el-table"),A=c("el-pagination"),L=X("loading");return y(),G("div",null,[Y("div",ce,[e(o(ie),{params:u.value,onSearch:j,onReset:E},{default:t(()=>[e(o(de),{label:a.$t("tag.name"),name:"Q_Contains_name"},null,8,["label"])]),_:1},8,["params"])]),Y("div",null,[e(g,{type:"primary",disabled:o(z)("tag:create"),icon:o(ae),onClick:l[0]||(l[0]=()=>F())},{default:t(()=>[$(V(a.$t("add")),1)]),_:1},8,["disabled","icon"]),e(_,{title:a.$t("confirmDelete"),onConfirm:l[1]||(l[1]=()=>U(I.value.map(s=>s.id)))},{reference:t(()=>[e(g,{disabled:I.value.length<=0||o(z)("tag:delete"),icon:o(le)},{default:t(()=>[$(V(a.$t("delete")),1)]),_:1},8,["disabled","icon"])]),_:1},8,["title"]),e(o(me),{name:"tag",class:"ml-2"})]),Y("div",ge,[K((y(),k(Q,{ref_key:"table",ref:d,data:i.value,onSelectionChange:l[2]||(l[2]=s=>I.value=s),onRowDblclick:l[3]||(l[3]=s=>B(s.id)),onSortChange:R},{default:t(()=>[e(o(pe),{name:"tag"},{default:t(()=>[e(v,{type:"selection",width:"45"}),e(v,{property:"id",label:"ID",width:"64",sortable:"custom"}),e(v,{property:"name",label:a.$t("tag.name"),sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),e(v,{property:"description",label:a.$t("tag.description"),sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),e(v,{property:"created",label:a.$t("tag.created"),sortable:"custom","show-overflow-tooltip":""},{default:t(({row:s})=>[$(V(o(M)(s.created).format("YYYY-MM-DD HH:mm")),1)]),_:1},8,["label"]),e(v,{property:"user.username",label:a.$t("tag.user"),sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),e(v,{property:"refers",label:a.$t("tag.refers"),sortable:"refers","show-overflow-tooltip":""},null,8,["label"]),e(v,{label:a.$t("table.action")},{default:t(({row:s})=>[e(g,{type:"primary",disabled:o(z)("tag:update"),size:"small",link:"",onClick:()=>B(s.id)},{default:t(()=>[$(V(a.$t("edit")),1)]),_:2},1032,["disabled","onClick"]),e(_,{title:a.$t("confirmDelete"),onConfirm:()=>U([s.id])},{reference:t(()=>[e(g,{type:"primary",disabled:o(z)("tag:delete"),size:"small",link:""},{default:t(()=>[$(V(a.$t("delete")),1)]),_:1},8,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1})]),_:1},8,["data"])),[[L,q.value]]),e(A,{currentPage:n.value,"onUpdate:currentPage":l[4]||(l[4]=s=>n.value=s),pageSize:p.value,"onUpdate:pageSize":l[5]||(l[5]=s=>p.value=s),total:f.value,"page-sizes":o(te),layout:o(oe),small:"",background:"",class:"px-3 py-2 justify-end",onSizeChange:l[6]||(l[6]=()=>b()),onCurrentChange:l[7]||(l[7]=()=>b())},null,8,["currentPage","pageSize","total","page-sizes","layout"])]),e(ve,{modelValue:D.value,"onUpdate:modelValue":l[8]||(l[8]=s=>D.value=s),"bean-id":P.value,"bean-ids":o(N),onFinished:b},null,8,["modelValue","bean-id","bean-ids"])])}}});export{Ce as default};
