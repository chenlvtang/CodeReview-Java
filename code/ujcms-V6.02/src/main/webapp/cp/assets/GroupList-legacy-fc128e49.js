System.register(["./index-legacy-1e63c30f.js","./user-legacy-909e3dc4.js","./QueryItem.vue_vue_type_script_setup_true_lang-legacy-e3a8d33d.js","./ListMove.vue_vue_type_script_setup_true_lang-legacy-d11492bd.js","./DialogForm.vue_vue_type_script_setup_true_lang-legacy-fd3043ab.js","./LabelTip.vue_vue_type_script_setup_true_lang-legacy-6e6f943f.js","./tree-legacy-035e50cc.js","./content-legacy-136d9c10.js"],(function(e,l){"use strict";var a,t,u,s,o,d,n,i,r,c,p,m,v,b,y,f,g,_,h,V,k,$,w,C,A,P,U,j,x,I,q,D,F,S,z,N,R,B,E,G,L,Q,H,K,M,O,T;return{setters:[e=>{a=e.d,t=e.r,u=e.a,s=e.c,o=e.e,d=e.w,n=e.i,i=e.h,r=e.I,c=e.a8,p=e.a7,m=e.p,v=e.u,b=e.X,y=e.v,f=e.o,g=e.V,_=e.j,h=e.g,V=e.k,k=e.t,$=e.E,w=e.b,C=e.f,A=e.aD,P=e.aJ,U=e.aL,j=e.as,x=e.a5,I=e.a2},e=>{q=e.C,D=e.D,F=e.E,S=e.F,z=e.G,N=e.H,R=e.f,B=e.I},e=>{E=e.a,G=e._,L=e.b,Q=e.c},e=>{H=e._},e=>{K=e._},e=>{M=e._},e=>{O=e.t},e=>{T=e.g}],execute:function(){const l=a({name:"GroupForm",props:{modelValue:{type:Boolean,required:!0},beanId:{type:Number,default:null},beanIds:{type:Array,required:!0}},emits:{"update:modelValue":null,finished:null},setup(e){const l=t(),a=t({});return(t,m)=>{const v=u("el-input"),b=u("el-form-item"),y=u("el-switch"),f=u("el-option"),g=u("el-select");return s(),o(K,{values:a.value,"onUpdate:values":m[4]||(m[4]=e=>a.value=e),name:t.$t("menu.user.group"),"query-bean":n(q),"create-bean":n(D),"update-bean":n(F),"delete-bean":n(S),"bean-id":e.beanId,"bean-ids":e.beanIds,focus:l.value,"init-values":()=>({type:2,allAccessPermission:!0}),"to-values":e=>({...e}),"disable-delete":e=>e.id<=10,perms:"group","model-value":e.modelValue,"onUpdate:modelValue":m[5]||(m[5]=e=>t.$emit("update:modelValue",e)),onFinished:m[6]||(m[6]=()=>t.$emit("finished"))},{default:d((({})=>[i(b,{prop:"name",label:t.$t("group.name"),rules:{required:!0,message:()=>t.$t("v.required")}},{default:d((()=>[i(v,{ref_key:"focus",ref:l,modelValue:a.value.name,"onUpdate:modelValue":m[0]||(m[0]=e=>a.value.name=e),maxlength:"50"},null,8,["modelValue"])])),_:1},8,["label","rules"]),i(b,{prop:"description",label:t.$t("group.description")},{default:d((()=>[i(v,{modelValue:a.value.description,"onUpdate:modelValue":m[1]||(m[1]=e=>a.value.description=e),maxlength:"255"},null,8,["modelValue"])])),_:1},8,["label"]),i(b,{prop:"allAccessPermission"},{label:d((()=>[i(M,{message:"group.allAccessPermission"})])),default:d((()=>[i(y,{modelValue:a.value.allAccessPermission,"onUpdate:modelValue":m[2]||(m[2]=e=>a.value.allAccessPermission=e)},null,8,["modelValue"])])),_:1}),i(b,{prop:"type",label:t.$t("group.type"),rules:{required:!0,message:()=>t.$t("v.required")}},{default:d((()=>[i(g,{modelValue:a.value.type,"onUpdate:modelValue":m[3]||(m[3]=e=>a.value.type=e),disabled:1===a.value.type},{default:d((()=>[(s(),r(p,null,c([1,2],(e=>i(f,{key:e,disabled:1===e,label:t.$t(`group.type.${e}`),value:e},null,8,["disabled","label","value"]))),64))])),_:1},8,["modelValue","disabled"])])),_:1},8,["label","rules"])])),_:1},8,["values","name","query-bean","create-bean","update-bean","delete-bean","bean-id","bean-ids","focus","init-values","to-values","disable-delete","model-value"])}}}),J={class:"border-t"},X={class:"flex justify-between items-center"},W=a({name:"UserPermissionForm",props:{modelValue:{type:Boolean,required:!0},beanId:{type:Number,default:null}},emits:{"update:modelValue":null,finished:null},setup(e,{emit:l}){const a=e,{beanId:c,modelValue:w}=m(a),{t:C}=v(),A=t(),P=t({}),U=t({}),j=t(!1),x=t(!0),I=t(!1),D=t(),F=t([]),S=b((()=>g.rank>P.value.rank));y(w,(()=>{w.value&&((async()=>{null!=c?.value&&(P.value=await q(c.value),U.value={...P.value})})(),(async()=>{if(null!=c?.value){const e=await N(c.value);D.value?.setCheckedKeys([]),e.forEach((e=>{D.value?.setChecked(e,!0,!1)}))}})())})),f((()=>{(async()=>{F.value=O(await T())})()}));const R=(e,l,a,t)=>{a.forEach((a=>{a.children&&(l.getNode(a[t??"key"]).expanded=e,R(e,l,a.children,t))}))},B=()=>{null!=D.value&&(U.value.accessPermissions=[...D.value.getCheckedNodes(),...D.value.getHalfCheckedNodes()].map((e=>e.id)))};return(a,t)=>{const c=u("el-switch"),m=u("el-form-item"),v=u("el-checkbox"),b=u("el-tree"),y=u("el-form"),f=u("el-tag"),g=u("el-button"),w=u("el-drawer");return s(),o(w,{title:a.$t("permissionSettings"),"model-value":e.modelValue,size:414,"onUpdate:modelValue":t[8]||(t[8]=e=>a.$emit("update:modelValue",e))},{default:d((()=>[i(y,{ref_key:"form",ref:A,model:U.value,disabled:n(S),"label-width":"150px"},{default:d((()=>[i(m,{prop:"allAccessPermission"},{label:d((()=>[i(M,{message:"group.allAccessPermission",help:""})])),default:d((()=>[i(c,{modelValue:U.value.allAccessPermission,"onUpdate:modelValue":t[0]||(t[0]=e=>U.value.allAccessPermission=e)},null,8,["modelValue"])])),_:1}),U.value.allAccessPermission?h("",!0):(s(),r(p,{key:0},[_("div",J,[i(v,{modelValue:x.value,"onUpdate:modelValue":t[1]||(t[1]=e=>x.value=e),label:a.$t("expand/collapse"),onChange:t[2]||(t[2]=e=>R(e,D.value,F.value,"id"))},null,8,["modelValue","label"]),i(v,{modelValue:I.value,"onUpdate:modelValue":t[3]||(t[3]=e=>I.value=e),label:a.$t("checkAll/uncheckAll"),onChange:t[4]||(t[4]=e=>{((e,l,a,t)=>{l.setCheckedKeys(e?a.map((e=>e[t??"key"])):[])})(e,D.value,F.value,"id"),B()})},null,8,["modelValue","label"])]),i(b,{ref_key:"accessPermissionTree",ref:D,data:F.value,"node-key":"id",props:{label:"name"},class:"border rounded","default-expand-all":"","show-checkbox":"",onCheck:t[5]||(t[5]=()=>B())},null,8,["data"])],64))])),_:1},8,["model","disabled"])])),footer:d((()=>[_("div",X,[_("div",null,[i(f,null,{default:d((()=>[V(k(U.value?.name),1)])),_:1})]),_("div",null,[i(g,{onClick:t[6]||(t[6]=()=>a.$emit("update:modelValue",!1))},{default:d((()=>[V(k(a.$t("cancel")),1)])),_:1}),i(g,{type:"primary",loading:j.value,disabled:n(S),onClick:t[7]||(t[7]=()=>{A.value.validate((async e=>{if(e){j.value=!0;try{await z(U.value),l("finished"),l("update:modelValue",!1),$.success(C("success"))}finally{j.value=!1}}}))})},{default:d((()=>[V(k(a.$t("save")),1)])),_:1},8,["loading","disabled"])])])])),_:1},8,["title","model-value"])}}}),Y={class:"mb-3"},Z={class:"app-block mt-3"};e("default",a({name:"GroupList",setup(e){const{t:a}=v(),c=t({}),p=t(),m=t(),y=t([]),q=t([]),D=t(!1),F=t(!1),z=t(!1),N=t(),K=b((()=>y.value.map((e=>e.id)))),M=t(!1),O=async()=>{D.value=!0;try{y.value=await R({...A(c.value),Q_OrderBy:p.value}),M.value=Object.values(c.value).filter((e=>void 0!==e&&""!==e)).length>0||void 0!==p.value}finally{D.value=!1}};f(O);const T=({column:e,prop:l,order:a})=>{p.value=l?(e.sortBy??l)+("descending"===a?"_desc":""):void 0,O()},J=()=>O(),X=()=>{m.value.clearSort(),P(c.value),p.value=void 0,O()},ee=()=>{N.value=void 0,F.value=!0},le=e=>{N.value=e,F.value=!0},ae=e=>e>10,te=async e=>{const l=e.filter((e=>ae(e)));l.length>0&&(await S(l),O(),$.success(a("success")))};return(e,a)=>{const t=u("el-button"),p=u("el-popconfirm"),v=u("el-table-column"),b=u("el-tag"),f=u("el-table"),$=w("loading");return s(),r("div",null,[_("div",Y,[i(n(G),{params:c.value,onSearch:J,onReset:X},{default:d((()=>[i(n(E),{label:e.$t("group.name"),name:"Q_Contains_name"},null,8,["label"]),i(n(E),{label:e.$t("group.description"),name:"Q_Contains_description"},null,8,["label"])])),_:1},8,["params"])]),_("div",null,[i(t,{type:"primary",disabled:n(j)("group:create"),icon:n(x),onClick:ee},{default:d((()=>[V(k(e.$t("add")),1)])),_:1},8,["disabled","icon"]),i(p,{title:e.$t("confirmDelete"),onConfirm:a[0]||(a[0]=()=>te(q.value.map((e=>e.id))))},{reference:d((()=>[i(t,{disabled:q.value.filter((e=>ae(e.id))).length<=0||n(j)("group:delete"),icon:n(I)},{default:d((()=>[V(k(e.$t("delete")),1)])),_:1},8,["disabled","icon"])])),_:1},8,["title"]),i(H,{class:"ml-2",disabled:q.value.length<=0||M.value||n(j)("org:update"),onMove:a[1]||(a[1]=e=>(async(e,l)=>{const a=U(e,y.value,l);await B(a.map((e=>e.id)))})(q.value,e))},null,8,["disabled"]),i(n(L),{name:"group",class:"ml-2"})]),_("div",Z,[C((s(),o(f,{ref_key:"table",ref:m,data:y.value,onSelectionChange:a[2]||(a[2]=e=>q.value=e),onRowDblclick:a[3]||(a[3]=e=>le(e.id)),onSortChange:T},{default:d((()=>[i(n(Q),{name:"group"},{default:d((()=>[i(v,{type:"selection",width:"50"}),i(v,{property:"id",label:"ID",width:"64",sortable:"custom"}),i(v,{property:"name",label:e.$t("group.name"),sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),i(v,{property:"description",label:e.$t("group.description"),"min-width":"150",sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),i(v,{property:"allAccessPermission",label:e.$t("group.allAccessPermission"),sortable:"custom"},{default:d((({row:l})=>[i(b,{type:l.allAccessPermission?"success":"info",size:"small"},{default:d((()=>[V(k(e.$t(l.allAccessPermission?"yes":"no")),1)])),_:2},1032,["type"])])),_:1},8,["label"]),i(v,{property:"type",label:e.$t("group.type"),sortable:"custom","show-overflow-tooltip":"",formatter:l=>e.$t(`group.type.${l.type}`)},null,8,["label","formatter"]),i(v,{label:e.$t("table.action")},{default:d((({row:l})=>[i(t,{type:"primary",disabled:n(j)("group:update"),size:"small",link:"",onClick:e=>le(l.id)},{default:d((()=>[V(k(e.$t("edit")),1)])),_:2},1032,["disabled","onClick"]),n(g).epRank>0||n(g).epDisplay?(s(),o(t,{key:0,type:"primary",disabled:n(j)("group:updatePermission")||n(g).epRank<=0,title:n(g).epRank<=0?e.$t("error.enterprise.short"):void 0,size:"small",link:"",onClick:()=>{return e=l.id,N.value=e,void(z.value=!0);var e}},{default:d((()=>[V(k(e.$t("permissionSettings")),1)])),_:2},1032,["disabled","title","onClick"])):h("",!0),i(p,{title:e.$t("confirmDelete"),onConfirm:()=>te([l.id])},{reference:d((()=>[i(t,{type:"primary",disabled:!ae(l.id)||n(j)("group:delete"),size:"small",link:""},{default:d((()=>[V(k(e.$t("delete")),1)])),_:2},1032,["disabled"])])),_:2},1032,["title","onConfirm"])])),_:1},8,["label"])])),_:1})])),_:1},8,["data"])),[[$,D.value]])]),i(l,{modelValue:F.value,"onUpdate:modelValue":a[4]||(a[4]=e=>F.value=e),"bean-id":N.value,"bean-ids":n(K),onFinished:O},null,8,["modelValue","bean-id","bean-ids"]),i(W,{modelValue:z.value,"onUpdate:modelValue":a[5]||(a[5]=e=>z.value=e),"bean-id":N.value,onFinished:O},null,8,["modelValue","bean-id"])])}}}))}}}));
