import{al as L,an as Q,d as w,p as U,r as I,v as M,a as g,c as f,I as V,h as _,w as b,i as a,cG as x,k as O,t as j,j as T,a7 as q,a8 as B,u as z,X as J,cj as D,a5 as H,cH as W,e as h,cI as X,l as K,cJ as Y,bW as Z,aO as P,b0 as ee}from"./index-285670b0.js";const R="ujcms_column_settings";function te(){const t=localStorage.getItem(R);return t?JSON.parse(t):{}}const N=L({}),$=L(te());function le(){localStorage.setItem(R,JSON.stringify($))}const ne=t=>(N[t]||(N[t]=[]),Q(N,t)),A=(t,d)=>{for(let l=0,s=t.length;l<s;)d.findIndex(m=>m.title===t[l].title)===-1?(t.splice(l,1),s-=1):l+=1;return d.forEach(l=>{t.findIndex(s=>s.title===l.title)===-1&&t.push({...l})}),t},ae=(t,d)=>{N[t]=d,$[t]||($[t]=[]);const l=$[t];A(l,d)},F=t=>($[t]||($[t]=[]),Q($,t)),oe={class:"inline-flex align-middle"},se=["divided"],pe=w({__name:"ColumnSetting",props:{name:{type:String,required:!0}},setup(t){const d=t,{name:l}=U(d),s=F(l.value),m=ne(l.value),i=I(!1);M(s,()=>le(),{deep:!0});const k=()=>{s.value=A([],m.value)};return(u,c)=>{const r=g("el-icon"),y=g("el-tooltip"),e=g("el-button"),n=g("el-checkbox"),p=g("el-drawer");return f(),V("div",oe,[_(y,{content:u.$t("table.columnsSetting"),placement:"top"},{default:b(()=>[_(r,{class:"cursor-pointer text-lg text-gray-regular",onClick:c[0]||(c[0]=()=>i.value=!0)},{default:b(()=>[_(a(x))]),_:1})]),_:1},8,["content"]),_(p,{modelValue:i.value,"onUpdate:modelValue":c[1]||(c[1]=v=>i.value=v),title:u.$t("table.columnsSetting"),size:375},{default:b(()=>[_(e,{class:"mb-1",round:"",onClick:k},{default:b(()=>[O(j(u.$t("reset")),1)]),_:1}),T("ul",null,[(f(!0),V(q,null,B(a(s),(v,o)=>(f(),V("li",{key:v.title,divided:o===0},[_(n,{modelValue:v.display,"onUpdate:modelValue":E=>v.display=E},{default:b(()=>[O(j(v.title),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])],8,se))),128))])]),_:1},8,["modelValue","title"])])}}}),me=w({name:"ColumnList",props:{name:{type:String,required:!0}},setup(t,{slots:d}){var r,y;const{name:l}=U(t),{t:s}=z(),m=(y=(r=d.default)==null?void 0:r.call(d))!=null?y:[],i=e=>(e==null?void 0:e.type)==="selection"?s("table.selection"):e==null?void 0:e.label,k=m.map(e=>{var n;return{title:i(e.props),display:((n=e.props)==null?void 0:n.display)!=="none"}});ae(l.value,k);const u=F(l.value);return{columns:J(()=>m.filter(e=>{const n=u.value.find(p=>i(e.props)===p.title);return!n||n.display}).map(e=>({...e,key:i(e.props)})).sort((e,n)=>{let p=u.value.findIndex(o=>o.title===i(e));p<0&&(p=m.findIndex(o=>i(o)===i(e)));let v=u.value.findIndex(o=>o.title===i(n));return v<0&&(v=m.findIndex(o=>i(o)===i(n))),p-v}))}},render(){return this.columns}}),ue=w({name:"QueryInput",props:{inputs:{type:Array,required:!0},name:{type:String,required:!0}},setup(t){const{inputs:d,name:l}=U(t);return()=>d.value.find(s=>s.props.name===l.value)}}),re={class:"flex"},ie={class:"space-y-1"},fe=w({__name:"QueryForm",props:{params:{type:Object,required:!0}},emits:{search:null,reset:null},setup(t){const d=t,{params:l}=U(d),s=D();Z("params",l);const m=I([]),i=J(()=>{var e,n;return(n=(e=s.default)==null?void 0:e.call(s))!=null?n:[]});m.value=i.value.map(e=>{var n,p;return{label:(n=e.props)==null?void 0:n.label,name:(p=e.props)==null?void 0:p.name}});const[k]=m.value,u=I([k.name]),c=J(()=>m.value.filter(e=>!u.value.includes(e.name))),r=()=>{Object.keys(l.value).forEach(e=>{!u.value.includes(e)&&u.value.findIndex(n=>n.split(",").includes(e))===-1&&delete l.value[e]})},y=e=>{if(e===0){const[n]=c.value;u.value[u.value.length]=n.name}else u.value.splice(e,1),r()};return(e,n)=>{const p=g("el-button"),v=g("el-option"),o=g("el-select"),E=g("el-button-group");return f(),V("form",re,[T("div",ie,[(f(!0),V(q,null,B(u.value,(G,C)=>(f(),V("div",{key:G,class:"flex"},[_(p,{icon:C==0?a(H):a(W),disabled:C<=0&&a(c).length<=0,circle:"",onClick:()=>y(C)},null,8,["icon","disabled","onClick"]),_(o,{modelValue:u.value[C],"onUpdate:modelValue":S=>u.value[C]=S,class:"w-36",onChange:n[0]||(n[0]=()=>r())},{default:b(()=>[(f(!0),V(q,null,B(m.value.filter(S=>S.name===u.value[C]||a(c).includes(S)),S=>(f(),h(v,{key:S.name,label:S.label,value:S.name},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),_(ue,{inputs:a(i),name:u.value[C]},null,8,["inputs","name"])]))),128))]),T("div",null,[_(E,{class:"ml-2"},{default:b(()=>[_(p,{"native-type":"submit",icon:a(X),onClick:n[1]||(n[1]=K(()=>e.$emit("search"),["prevent"]))},{default:b(()=>[O(j(e.$t("search")),1)]),_:1},8,["icon"]),_(p,{icon:a(Y),onClick:n[2]||(n[2]=()=>e.$emit("reset"))},{default:b(()=>[O(j(e.$t("reset")),1)]),_:1},8,["icon"])]),_:1})])])}}}),de={key:0,class:"inline-block"},ve=w({__name:"QueryItem",props:{label:{type:String,required:!0},name:{type:String,required:!0},type:{type:String,default:null},options:{type:Object,default:null}},setup(t){const d=t,l=P("params"),{name:s}=U(d),[m,i]=s.value.split(","),k=I(m),u=I(i);return(c,r)=>{const y=g("el-input-number"),e=g("el-date-picker"),n=g("el-option"),p=g("el-select"),v=g("el-input");return ee(c.$slots,"default",{},()=>[t.type==="number"?(f(),V("div",de,[_(y,{modelValue:a(l)[k.value],"onUpdate:modelValue":r[0]||(r[0]=o=>a(l)[k.value]=o),placeholder:c.$t("begin.number"),class:"w-48"},null,8,["modelValue","placeholder"]),_(y,{modelValue:a(l)[u.value],"onUpdate:modelValue":r[1]||(r[1]=o=>a(l)[u.value]=o),placeholder:c.$t("end.number"),class:"w-48"},null,8,["modelValue","placeholder"])])):t.type==="date"?(f(),h(e,{key:1,modelValue:a(l)[a(s)],"onUpdate:modelValue":r[2]||(r[2]=o=>a(l)[a(s)]=o),type:"daterange","start-placeholder":c.$t("begin.date"),"end-placeholder":c.$t("end.date"),class:"w-96"},null,8,["modelValue","start-placeholder","end-placeholder"])):t.type==="datetime"?(f(),h(e,{key:2,modelValue:a(l)[a(s)],"onUpdate:modelValue":r[3]||(r[3]=o=>a(l)[a(s)]=o),type:"datetimerange","start-placeholder":c.$t("begin.date"),"end-placeholder":c.$t("end.date"),class:"w-96"},null,8,["modelValue","start-placeholder","end-placeholder"])):t.options?(f(),h(p,{key:3,modelValue:a(l)[a(s)],"onUpdate:modelValue":r[4]||(r[4]=o=>a(l)[a(s)]=o),multiple:"",class:"w-96"},{default:b(()=>[(f(!0),V(q,null,B(t.options,o=>(f(),h(n,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):(f(),h(v,{key:4,modelValue:a(l)[a(s)],"onUpdate:modelValue":r[5]||(r[5]=o=>a(l)[a(s)]=o),class:"w-96"},null,8,["modelValue"]))])}}});export{fe as _,ve as a,pe as b,me as c};
